machine:
  environment:
    DATABASE_URL: mysql://ubuntu:@localhost:3306/circle_test
    CUSTOM_DATABASE_URL: mysql://ubuntu:@localhost:3306/circle_test

dependencies:
  override:
    - pip install -U -r requirements/test.txt codecov flake8

test:
  pre:
    - echo '{"SCRATCH": {"DB_TYPE": "mysql", "DB": "scratch", "HOST": "localhost", "PWD": "django", "USER": "django", "PORT": 3306}, "SECRET_KEY": "j_-af1@u(h7j%nklasdfkjahsdkhaslghas;", "EMAIL": {"EMAIL_HOST_PASSWORD": "asdgasgasdfa", "EMAIL_PORT": 587, "EMAIL_USE_TLS": true, "EMAIL_HOST_USER": "test@gmail.com", "EMAIL_HOST": "smtp.gmail.com"}, "DJANO": {"DB_TYPE": "mysql", "DB": "scratch", "HOST": "localhost", "PWD": "django", "USER": "django", "PORT": 3306}}' > chartly/passwords.json
  override:
    - flake8 tests/
    - coverage run manage.py test
  post:
    - codecov --token=e40d6920-9464-459f-9bdf-5ff4f57fe6c5
